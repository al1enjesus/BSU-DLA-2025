# Отчёт по лабораторной работе 1 — Bash: анализ логов

**Выполнил:** Соколов Евгений  
**Группа:** gr1sub1  
**Дата:** 16 сентября 2025

## Цель работы
Изучить базовые инструменты командной строки Linux для анализа файлов логов, освоить работу с конвейерами команд и выполнить частотный анализ данных.

## Подготовка среды

### Проверка доступности файлов логов
```bash
ls -la /var/log/
```

**Результат:** Все необходимые файлы доступны:
- `/var/log/syslog` - 98486 байт
- `/var/log/auth.log` - 871 байт  
- `/var/log/dpkg.log` - 41461 байт

## Задание А: Частотный анализ слов в syslog (TOP-5)

### Команда и пояснение
```bash
cat /var/log/syslog \
  | tr -cs '[:alnum:]' '\n' \
  | tr '[:upper:]' '[:lower:]' \
  | sort \
  | uniq -c \
  | sort -nr \
  | head -n 5
```

**Пошаговое объяснение:**
1. `cat /var/log/syslog` - читаем содержимое файла syslog
2. `tr -cs '[:alnum:]' '\n'` - заменяем все символы кроме буквенно-цифровых на новые строки
3. `tr '[:upper:]' '[:lower:]'` - приводим к нижнему регистру
4. `sort` - сортируем слова в алфавитном порядке
5. `uniq -c` - подсчитываем уникальные вхождения
6. `sort -nr` - сортируем по количеству в убывающем порядке
7. `head -n 5` - берём первые 5 записей

### Результат
```
   1055 16
   1038 18
   1036 jarvis
   1034 sep
    984 41
```

### Анализ результатов
Самые частые "слова" в syslog:
1. **16** (1055 раз) - время (час)
2. **18** (1038 раз) - время (час) 
3. **jarvis** (1036 раз) - имя хоста
4. **sep** (1034 раз) - сокращение месяца September
5. **41** (984 раза) - время (минуты)

Результаты показывают, что наиболее часто встречаются компоненты временных меток и имя хоста системы.

## Задание Б: Анализ неудачных попыток входа (auth.log)

### Проверка наличия неудачных попыток
```bash
grep -E "(Failed|Invalid)" /var/log/auth.log
```

**Результат:** В текущем auth.log нет записей о неудачных попытках входа.

### Создание демонстрационных данных
Для демонстрации работы команд создан файл с примерами неудачных попыток входа:

```bash
echo "Sep 16 18:41:19 Jarvis sshd[1234]: Failed password for admin from 192.168.1.100 port 22 ssh2
Sep 16 18:41:20 Jarvis sshd[1235]: Invalid user test from 10.0.0.15 port 22
Sep 16 18:41:21 Jarvis sshd[1236]: Failed password for root from 192.168.1.100 port 22 ssh2
Sep 16 18:41:22 Jarvis sshd[1237]: Invalid user admin from 172.16.0.20 port 22
Sep 16 18:41:23 Jarvis sshd[1238]: Failed password for user from 192.168.1.50 port 22 ssh2" >
```

### Извлечение и анализ IP-адресов
```bash
grep -E "(Failed|Invalid)" logs/auth_sample.log \
  | grep -oE '[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+' \
  | sort \
  | uniq -c \
  | sort -nr \
  | head -10
```

**Результат:**
```
      2 192.168.1.100
      1 192.168.1.50
      1 172.16.0.20
      1 10.0.0.15
```

### Анализ результатов
- Наиболее активные источники атак из подсети 192.168.1.x (3 попытки)
- Единичные попытки из подсетей 172.16.0.x и 10.0.0.x

## Задание В: Анализ установок пакетов (dpkg.log)

### Команда и результат
```bash
grep " install " /var/log/dpkg.log \
  | awk '{print $4}' \
  | sort \
  | uniq -c \
  | sort -nr \
  | head -10
```

**Результат:**
```
      1 x11-utils:amd64
      1 x11-common:all
      1 wslu:all
      1 update-motd:all
      1 ubuntu-wsl:amd64
      1 show-motd:all
      1 pulseaudio-utils:amd64
      1 mesa-vulkan-drivers:amd64
      1 libxxf86vm1:amd64
      1 libxxf86dga1:amd64
```

### Анализ результатов
- Все пакеты устанавливались по одному разу
- Основные категории пакетов:
  - **X11 пакеты** (x11-utils, x11-common, libxxf86*) - графическая подсистема
  - **WSL пакеты** (wslu, ubuntu-wsl) - поддержка Windows Subsystem for Linux
  - **Мультимедиа** (pulseaudio-utils, mesa-vulkan-drivers) - аудио и графика
  - **Системные** (update-motd, show-motd) - система сообщений при входе

## Дополнительные команды для проверки

### Подсчёт общего количества строк в логах
```bash
wc -l /var/log/syslog /var/log/auth.log /var/log/dpkg.log
```

### Просмотр последних записей
```bash
tail -5 /var/log/syslog
```

### Поиск конкретных событий
```bash
grep -i "error" /var/log/syslog | head -5
```

## Ключевые выводы

1. **Анализ syslog:** Временные метки и имена хостов составляют основную массу слов в системных логах.

2. **Анализ auth.log:** В текущей системе нет записей о неудачных попытках входа, что говорит о безопасности или отсутствии внешних атак.

3. **Анализ dpkg.log:** Установленные пакеты относятся к WSL-окружению с поддержкой графики и мультимедиа.

4. **Инструменты:** Комбинация `grep`, `awk`, `sort`, `uniq`, `sed` позволяет эффективно анализировать структурированные текстовые данные.

## Воспроизводимость

Все команды безопасны и могут быть выполнены без административных привилегий. 

## Использование AI

В процессе выполнения работы AI-помощник ассистировал в оформлении отчёта в формате Markdown

Все команды были проверены вручную и выполнены в реальной системе.
