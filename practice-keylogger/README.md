# –ü—Ä–∞–∫—Ç–∏–∫–∞: Keylogger ‚Äî –ü–µ—Ä–µ—Ö–≤–∞—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ —è–¥—Ä–∞

## –ö–æ–Ω—Ç–µ–∫—Å—Ç

–ü–æ—Å–ª–µ –∏–∑—É—á–µ–Ω–∏—è **Lab5** (–º–æ–¥—É–ª–∏ —è–¥—Ä–∞, /proc, character devices) –ø—Ä–∏—à–ª–æ –≤—Ä–µ–º—è –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∑–Ω–∞–Ω–∏—è –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ.

–í—ã —Å–æ–∑–¥–∞–¥–∏—Ç–µ –º–æ–¥—É–ª—å —è–¥—Ä–∞ Linux, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Ö –≤ –±—É—Ñ–µ—Ä, –¥–æ—Å—Ç—É–ø–Ω—ã–π –¥–ª—è —á—Ç–µ–Ω–∏—è —á–µ—Ä–µ–∑ `/proc` –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

---

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û

**–≠—Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫–∞ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¢–û–õ–¨–ö–û –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π:**
- ‚úÖ –ó–∞–ø—É—Å–∫–∞—Ç—å –¢–û–õ–¨–ö–û –Ω–∞ —Å–≤–æ–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞)
- ‚ùå –ù–ï–ó–ê–ö–û–ù–ù–û –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞ —á—É–∂–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –±–µ–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
- ‚ùå –ù–ò–ö–û–ì–î–ê –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –Ω–∞ production —Å–∏—Å—Ç–µ–º—ã
- ‚öñÔ∏è –ù–∞—Ä—É—à–µ–Ω–∏–µ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —É–≥–æ–ª–æ–≤–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

### –£–≥–æ–ª–æ–≤–Ω–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å

**üáßüáæ –†–µ—Å–ø—É–±–ª–∏–∫–∞ –ë–µ–ª–∞—Ä—É—Å—å:**
- **[–°—Ç–∞—Ç—å—è 349 –£–ö –†–ë](https://zakony-by.com/ugolovnyj_kodeks_rb/349.htm)** - "–ù–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏"
  - –ß–∞—Å—Ç—å 1: –ª–∏—à–µ–Ω–∏–µ —Å–≤–æ–±–æ–¥—ã –¥–æ **2 –ª–µ—Ç**
  - –ß–∞—Å—Ç—å 2 (—Ç—è–∂–∫–∏–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è): –ª–∏—à–µ–Ω–∏–µ —Å–≤–æ–±–æ–¥—ã –¥–æ **7 –ª–µ—Ç**
- **[–°—Ç–∞—Ç—å—è 354 –£–ö –†–ë](https://zakony-by.com/ugolovnyj_kodeks_rb/354.htm)** - "–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–∏–±–æ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º"

**üá∑üá∫ –†–æ—Å—Å–∏–π—Å–∫–∞—è –§–µ–¥–µ—Ä–∞—Ü–∏—è:**
- **[–°—Ç–∞—Ç—å—è 272 –£–ö –†–§](https://www.consultant.ru/document/cons_doc_LAW_10699/5c337673c261a026c476d578035ce68a0ae86da0/)** - "–ù–µ–ø—Ä–∞–≤–æ–º–µ—Ä–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏"
  - –ß–∞—Å—Ç—å 1: –ª–∏—à–µ–Ω–∏–µ —Å–≤–æ–±–æ–¥—ã –¥–æ **4 –ª–µ—Ç**
  - –ß–∞—Å—Ç—å 4 (—Ç—è–∂–∫–∏–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è): –ª–∏—à–µ–Ω–∏–µ —Å–≤–æ–±–æ–¥—ã –¥–æ **7 –ª–µ—Ç**
- **[–°—Ç–∞—Ç—å—è 273 –£–ö –†–§](https://www.consultant.ru/document/cons_doc_LAW_10699/89bc61359acc5c61038e33f94f772b653d292000/)** - "–°–æ–∑–¥–∞–Ω–∏–µ, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º"
  - –ß–∞—Å—Ç—å 1: –ª–∏—à–µ–Ω–∏–µ —Å–≤–æ–±–æ–¥—ã –¥–æ **1.5 –≥–æ–¥–∞** + —à—Ç—Ä–∞—Ñ
  - –ß–∞—Å—Ç—å 3 (—Ç—è–∂–∫–∏–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è): –ª–∏—à–µ–Ω–∏–µ —Å–≤–æ–±–æ–¥—ã –¥–æ **7 –ª–µ—Ç**

**–° –±–æ–ª—å—à–æ–π —Å–∏–ª–æ–π –ø—Ä–∏—Ö–æ–¥–∏—Ç –±–æ–ª—å—à–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å.**

---

## –¶–µ–ª—å –ø—Ä–∞–∫—Ç–∏–∫–∏

1. –ü–æ–Ω—è—Ç—å, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç input subsystem –≤ —è–¥—Ä–µ Linux
2. –ù–∞—É—á–∏—Ç—å—Å—è –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ —è–¥—Ä–∞
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ —á—Ç–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ /proc
4. –û—Å–æ–∑–Ω–∞—Ç—å —Ä–∏—Å–∫–∏ keylogger'–æ–≤ –∏ –º–µ—Ç–æ–¥—ã –∑–∞—â–∏—Ç—ã –æ—Ç –Ω–∏—Ö

---

## –ó–∞–¥–∞—á–∞

–°–æ–∑–¥–∞—Ç—å kernel module, –∫–æ—Ç–æ—Ä—ã–π:
1. –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
2. –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à
3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Ö –≤ –∫–æ–ª—å—Ü–µ–≤–æ–π –±—É—Ñ–µ—Ä –≤ –ø–∞–º—è—Ç–∏ —è–¥—Ä–∞
4. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –ª–æ–≥—É —á–µ—Ä–µ–∑ `/proc/keylog`

–°—Ç—É–¥–µ–Ω—Ç—ã –¥–æ–ª–∂–Ω—ã –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É –º–æ–¥—É–ª—è –Ω–∞ –∑–∞–Ω—è—Ç–∏–∏.

---

## –í–æ–ø—Ä–æ—Å—ã –¥–ª—è —Ä–µ—à–µ–Ω–∏—è (–æ–±–¥—É–º–∞–π—Ç–µ –ø–µ—Ä–µ–¥ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π)

### –ß–∞—Å—Ç—å 1: Input Subsystem –≤ —è–¥—Ä–µ

1. **–ö–∞–∫ —è–¥—Ä–æ Linux –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –æ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤–≤–æ–¥–∞ (–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞, –º—ã—à—å)?**
   - –ü–æ–¥—Å–∏—Å—Ç–µ–º–∞: ?
   - –¢–∏–ø —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã: ?

2. **–ö–∞–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–æ–±—ã—Ç–∏–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã?**
   - –°—Ç—Ä—É–∫—Ç—É—Ä–∞: ?
   - –í–∞–∂–Ω—ã–µ –ø–æ–ª—è: type, code, value ‚Äî —á—Ç–æ –æ–Ω–∏ –æ–∑–Ω–∞—á–∞—é—Ç?

3. **–ö–∞–∫ –æ—Ç–ª–∏—á–∏—Ç—å –Ω–∞–∂–∞—Ç–∏–µ –∫–ª–∞–≤–∏—à–∏ –æ—Ç –æ—Ç–ø—É—Å–∫–∞–Ω–∏—è?**
   - value == 1: ?
   - value == 0: ?
   - value == 2: ?

---

### –ß–∞—Å—Ç—å 2: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞

4. **–ö–∞–∫—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –Ω—É–∂–Ω–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ —Å–æ–±—ã—Ç–∏–π?**
   - –°—Ç—Ä—É–∫—Ç—É—Ä–∞: struct ?
   - –ö–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è: ?

5. **–ö–∞–∫–∏–µ —Ç–∏–ø—ã —Å–æ–±—ã—Ç–∏–π –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –≤ `.evbit`?**
   - –ë–∏—Ç –¥–ª—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π: ?

6. **–ö–∞–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤ —è–¥—Ä–µ?**
   - –§—É–Ω–∫—Ü–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: ?
   - –§—É–Ω–∫—Ü–∏—è –æ—Ç–º–µ–Ω—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: ?

7. **–í –∫–∞–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–¥—É–ª—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è?**
   - –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –º–æ–¥—É–ª—è: —Ñ—É–Ω–∫—Ü–∏—è ?
   - –ü—Ä–∏ –≤—ã–≥—Ä—É–∑–∫–µ –º–æ–¥—É–ª—è: —Ñ—É–Ω–∫—Ü–∏—è ?

---

### –ß–∞—Å—Ç—å 3: –•—Ä–∞–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

8. **–ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—å –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω—ã–µ –∫–ª–∞–≤–∏—à–∏ –≤ –º–æ–¥—É–ª–µ —è–¥—Ä–∞?**
   - –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –º–∞—Å—Å–∏–≤ –∏–ª–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –ø–∞–º—è—Ç—å?
   - –§—É–Ω–∫—Ü–∏—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ –≤ —è–¥—Ä–µ: ?

9. **–ö–∞–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –±—É—Ñ–µ—Ä–∞?**
   - –°—Ç—Ä—É–∫—Ç—É—Ä–∞: ?
   - –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–∏: ?

10. **–ö–∞–∫ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–æ—Å—Ç—É–ø–∞ –∫ –±—É—Ñ–µ—Ä—É?**
    - –ú–µ—Ö–∞–Ω–∏–∑–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏: spinlock –∏–ª–∏ mutex?
    - –ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —ç—Ç–æ—Ç –º–µ—Ö–∞–Ω–∏–∑–º: ?

11. **–ù—É–∂–Ω–æ –ª–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å key codes –≤ —Å–∏–º–≤–æ–ª—ã?**
    - –í–∞—Ä–∏–∞–Ω—Ç 1: —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∫–æ–¥—ã –∫–ª–∞–≤–∏—à (KEY_A = 30)
    - –í–∞—Ä–∏–∞–Ω—Ç 2: —Å–æ—Ö—Ä–∞–Ω—è—Ç—å ASCII —Å–∏–º–≤–æ–ª—ã ('a', 'b')
    - –ö–∞–∫–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –ø—Ä–æ—â–µ: ?

---

### –ß–∞—Å—Ç—å 4: –ß—Ç–µ–Ω–∏–µ —á–µ—Ä–µ–∑ /proc

12. **–ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª –≤ /proc –¥–ª—è —á—Ç–µ–Ω–∏—è –ª–æ–≥–æ–≤?**
    - –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è: ?
    - –§—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è: ?

13. **–ö–∞–∫–æ–π callback –Ω—É–∂–µ–Ω –¥–ª—è —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞?**
    - –§—É–Ω–∫—Ü–∏—è —á—Ç–µ–Ω–∏—è: ?
    - –ß—Ç–æ –æ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å: ?

14. **–ö–∞–∫ –ø–µ—Ä–µ–¥–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ —è–¥—Ä–∞ –≤ userspace?**
    - –§—É–Ω–∫—Ü–∏—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è: ?
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–∫–∞–∑–∞—Ç–µ–ª–µ–π: ?

---

### –ß–∞—Å—Ç—å 5: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

15. **–ü–æ—á–µ–º—É keylogger —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫–∞–∫ –º–æ–¥—É–ª—å —è–¥—Ä–∞, –∞ –Ω–µ userspace –ø—Ä–æ—Ü–µ—Å—Å?**
    - –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ kernel-space: ?
    - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è userspace: ?

16. **–ö–∞–∫–∏–µ –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–µ —Ñ–∞–π–ª—ã —è–¥—Ä–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã?**
    - –î–ª—è –º–æ–¥—É–ª–µ–π: ?
    - –î–ª—è input subsystem: ?
    - –î–ª—è /proc: ?

17. **–í –∫–∞–∫–æ–º –ø–æ—Ä—è–¥–∫–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ/–≤—ã–≥—Ä—É–∑–∫–µ?**
    - –ü—Ä–∏ `insmod`: ?
    - –ü—Ä–∏ `rmmod`: ?

---

### –ß–∞—Å—Ç—å 6: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –∑–∞—â–∏—Ç–∞

18. **–ö–∞–∫ –º–æ–∂–Ω–æ –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å —Ç–∞–∫–æ–π keylogger –Ω–∞ —Å–∏—Å—Ç–µ–º–µ?**
    - –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –º–æ–¥—É–ª–µ–π: ?
    - –ì–¥–µ –∏—Å–∫–∞—Ç—å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ /proc –∑–∞–ø–∏—Å–∏: ?
    - –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å input handlers: ?

19. **–ö–∞–∫ –∑–∞—â–∏—Ç–∏—Ç—å—Å—è –æ—Ç kernel keylogger'–æ–≤?**
    - –ù–∞ —É—Ä–æ–≤–Ω–µ –∑–∞–≥—Ä—É–∑–∫–∏ —è–¥—Ä–∞: ?
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏: ?
    - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª–µ–π: ?

20. **–≠—Ç–∏—á–µ—Å–∫–∏–µ –∏ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –∞—Å–ø–µ–∫—Ç—ã:**
    - –í –∫–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ keylogger –ª–µ–≥–∞–ª—å–Ω–æ?
    - –ö–∞–∫–∏–µ –∑–∞–∫–æ–Ω—ã –Ω–∞—Ä—É—à–∞—é—Ç—Å—è –ø—Ä–∏ –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏?
    - –ö–∞–∫ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —ç—Ç–∏ –∑–Ω–∞–Ω–∏—è –¥–ª—è –∑–∞—â–∏—Ç—ã —Å–∏—Å—Ç–µ–º?

---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **–Ø–∑—ã–∫**: C (kernel module)
- **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞**: Linux (Ubuntu/Debian —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- **–í–µ—Ä—Å–∏—è —è–¥—Ä–∞**: 5.x –∏–ª–∏ –Ω–æ–≤–µ–µ
- **–°—Ä–µ–¥–∞**: –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞)

### –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

‚úÖ –ú–æ–¥—É–ª—å –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
‚úÖ –ú–æ–¥—É–ª—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è (`insmod`) –∏ –≤—ã–≥—Ä—É–∂–∞–µ—Ç—Å—è (`rmmod`) –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
‚úÖ –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à
‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫–ª–∞–≤–∏—à–∏ –≤ –±—É—Ñ–µ—Ä
‚úÖ –ú–æ–∂–Ω–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –ª–æ–≥ —á–µ—Ä–µ–∑ `cat /proc/keylog`
‚úÖ –ë—É—Ñ–µ—Ä –Ω–µ –ø–µ—Ä–µ–ø–æ–ª–Ω—è–µ—Ç—Å—è (–∫–æ–ª—å—Ü–µ–≤–æ–π –±—É—Ñ–µ—Ä)
‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –ø—Ä–∏ –≤—ã–≥—Ä—É–∑–∫–µ

---

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å —Å —ç—Ç–æ–π –ø—Ä–∞–∫—Ç–∏–∫–æ–π

1. **–ò–∑—É—á–∏—Ç–µ –≤–æ–ø—Ä–æ—Å—ã** –≤ –∫–∞–∂–¥–æ–π —á–∞—Å—Ç–∏
2. **–ò—Å—Å–ª–µ–¥—É–π—Ç–µ** –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é —è–¥—Ä–∞ –∏ –ø—Ä–∏–º–µ—Ä—ã –∏–∑ Lab5
3. **–†–µ–∞–ª–∏–∑—É–π—Ç–µ** –º–æ–¥—É–ª—å keylogger.c
4. **–°–æ–∑–¥–∞–π—Ç–µ Makefile** –¥–ª—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
5. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ** –≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ
6. **–ë—É–¥—å—Ç–µ –≥–æ—Ç–æ–≤—ã –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å** –Ω–∞ –∑–∞–Ω—è—Ç–∏–∏

---

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è

```bash
# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ input —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
cat /proc/bus/input/devices

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–±—ã—Ç–∏–π (—Ç—Ä–µ–±—É–µ—Ç root)
cat /dev/input/event0  # –∏–ª–∏ event1, event2...

# –°–ø–∏—Å–æ–∫ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –º–æ–¥—É–ª–µ–π
lsmod

# –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª—è
sudo insmod keylogger.ko

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ —è–¥—Ä–∞
dmesg | tail

# –ß—Ç–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω—ã—Ö –∫–ª–∞–≤–∏—à
cat /proc/keylog

# –í—ã–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª—è
sudo rmmod keylogger

# –ü—Ä–æ–≤–µ—Ä–∫–∞ input handlers
cat /proc/bus/input/handlers
```

---

## –ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- Input subsystem: `/usr/src/linux-headers-$(uname -r)/include/linux/input.h`
- –ü—Ä–∏–º–µ—Ä—ã –º–æ–¥—É–ª–µ–π –∏–∑ Lab5: `lab5/samples/`
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: `man proc`, `man insmod`, `man rmmod`
- Kernel documentation: https://www.kernel.org/doc/html/latest/

---

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–∞–∫—Ç–∏–∫–∏ –≤—ã –¥–æ–ª–∂–Ω—ã:

- ‚úÖ –ü–æ–Ω–∏–º–∞—Ç—å, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç input subsystem
- ‚úÖ –£–º–µ—Ç—å –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏—è —è–¥—Ä–∞
- ‚úÖ –ó–Ω–∞—Ç—å, –∫–∞–∫ —Å–æ–∑–¥–∞–≤–∞—Ç—å /proc –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
- ‚úÖ –£–º–µ—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ø–∞–º—è—Ç—å—é –≤ kernel space
- ‚úÖ –ü–æ–Ω–∏–º–∞—Ç—å —Ä–∏—Å–∫–∏ –∏ –º–µ—Ç–æ–¥—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è keylogger'–æ–≤
- ‚úÖ –£–º–µ—Ç—å –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É –º–æ–¥—É–ª—è

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —á–µ–ª–ª–µ–Ω–¥–∂–∏ (–¥–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö)

### üî• –£—Ä–æ–≤–µ–Ω—å 1: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –≤–≤–æ–¥ –ø–∞—Ä–æ–ª–µ–π (–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ `sudo`, `su` –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
- –ü–æ–º–µ—á–∞—Ç—å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### üî• –£—Ä–æ–≤–µ–Ω—å 2: –≠–∫—Å–ø–æ—Ä—Ç
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å –ª–æ–≥–∏ –≤ —Ñ–∞–π–ª –Ω–∞ –¥–∏—Å–∫–µ (–Ω–µ —Ç–æ–ª—å–∫–æ –≤ /proc)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `filp_open()` –∏ `kernel_write()`

### üî• –£—Ä–æ–≤–µ–Ω—å 3: –°–∫—Ä—ã—Ç–Ω–æ—Å—Ç—å
- –°–∫—Ä—ã—Ç—å –º–æ–¥—É–ª—å –∏–∑ –≤—ã–≤–æ–¥–∞ `lsmod`
- –£–¥–∞–ª–∏—Ç—å /proc –∑–∞–ø–∏—Å—å –∏–∑ —Å–ø–∏—Å–∫–∞ (rootkit —Ç–µ—Ö–Ω–∏–∫–∏)
- **–í–Ω–∏–º–∞–Ω–∏–µ**: —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ –∑–∞—â–∏—Ç—ã!

### üî• –£—Ä–æ–≤–µ–Ω—å 4: Timestamp –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
- –î–æ–±–∞–≤–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –∫ –∫–∞–∂–¥–æ–º—É –Ω–∞–∂–∞—Ç–∏—é
- –û–ø—Ä–µ–¥–µ–ª—è—Ç—å –∞–∫—Ç–∏–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (—á–µ—Ä–µ–∑ /proc/<pid>/comm)

---

## –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

–≠—Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫–∞ —É—á–∏—Ç –≤–∞—Å –ø–æ–Ω–∏–º–∞—Ç—å —É–≥—Ä–æ–∑—ã –∏ –∑–∞—â–∏—â–∞—Ç—å—Å—è –æ—Ç –Ω–∏—Ö. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–Ω–∞–Ω–∏—è —Ç–æ–ª—å–∫–æ –¥–ª—è:
- üéì –û–±—É—á–µ–Ω–∏—è
- üîí –£–ª—É—á—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- üõ°Ô∏è –ó–∞—â–∏—Ç—ã —Å–∏—Å—Ç–µ–º

**–£–¥–∞—á–∏! –ò –ø–æ–º–Ω–∏—Ç–µ: —Å –±–æ–ª—å—à–æ–π —Å–∏–ª–æ–π –ø—Ä–∏—Ö–æ–¥–∏—Ç –±–æ–ª—å—à–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å.** üõ°Ô∏è
