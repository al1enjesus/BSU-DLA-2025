# REPORT.MD - –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 3: /proc, —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

**–°—Ç—É–¥–µ–Ω—Ç:** [–õ—É–∫—å—è–Ω–æ–≤ –ù–∏–∫–∏—Ç–∞]  
**–û–∫—Ä—É–∂–µ–Ω–∏–µ:** Linux 6.14.0-32-generic (Ubuntu), x86_64

---

## –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã

–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å —É—Ç–∏–ª–∏—Ç—É `pstat` –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏–∑ `/proc/<pid>/*`, –Ω–∞—É—á–∏—Ç—å—Å—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –∏ —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è—Ç—å –∏—Ö —Å —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ —É—Ç–∏–ª–∏—Ç–∞–º–∏ (`ps`, `top`, `pidstat`).

---

## –û–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —É—Ç–∏–ª–∏—Ç—ã `pstat`

–£—Ç–∏–ª–∏—Ç–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤:

1. **`ProcFileReader`** ‚Äî —á–∏—Ç–∞–µ—Ç —Ñ–∞–π–ª—ã –∏–∑ `/proc`:
   - `readKeyValue()` ‚Äî –ø–∞—Ä—Å–∏—Ç —Ñ–∞–π–ª—ã —Ñ–æ—Ä–º–∞—Ç–∞ "–∫–ª—é—á: –∑–Ω–∞—á–µ–Ω–∏–µ" (`/proc/<pid>/status`, `/proc/<pid>/io`)
   - `readStatFile()` ‚Äî –ø–∞—Ä—Å–∏—Ç `/proc/<pid>/stat` –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç –ø–æ–ª—è `utime` (14-–µ –ø–æ–ª–µ) –∏ `stime` (15-–µ –ø–æ–ª–µ)

2. **`ProcStat`** ‚Äî —É–ø—Ä–∞–≤–ª—è–µ—Ç —Å–±–æ—Ä–æ–º –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö:
   - –ß–∏—Ç–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–∑ `config.json` (—Å–ø–∏—Å–æ–∫ –º–µ—Ç—Ä–∏–∫ –∏ –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è)
   - –°–æ–±–∏—Ä–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç—Ä—ë—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤: `/proc/<pid>/status`, `/proc/<pid>/io`, `/proc/<pid>/stat`
   - –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è —Å–æ–≥–ª–∞—Å–Ω–æ –µ–¥–∏–Ω–∏—Ü–∞–º –∏–∑–º–µ—Ä–µ–Ω–∏—è (KiB, MiB, ticks‚Üíseconds)
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `sysconf(_SC_CLK_TCK)` –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è HZ

### –°–æ–±–∏—Ä–∞–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –ò—Å—Ç–æ—á–Ω–∏–∫ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|----------|
| `PPid` | `/proc/<pid>/status` | Parent Process ID |
| `State` | `/proc/<pid>/status` | –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ (R/S/D/Z/T) |
| `Threads` | `/proc/<pid>/status` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤ |
| `VmRSS` | `/proc/<pid>/status` | Resident Set Size (—Ñ–∏–∑–∏—á–µ—Å–∫–∞—è –ø–∞–º—è—Ç—å) |
| `RssAnon` | `/proc/<pid>/status` | –ê–Ω–æ–Ω–∏–º–Ω–∞—è –ø–∞–º—è—Ç—å (heap, stack) |
| `RssFile` | `/proc/<pid>/status` | –§–∞–π–ª–æ–≤–∞—è –ø–∞–º—è—Ç—å (mmap, –±–∏–±–ª–∏–æ—Ç–µ–∫–∏) |
| `voluntary_ctxt_switches` | `/proc/<pid>/status` | –î–æ–±—Ä–æ–≤–æ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ |
| `nonvoluntary_ctxt_switches` | `/proc/<pid>/status` | –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ |
| `utime` | `/proc/<pid>/stat` (–ø–æ–ª–µ 14) | –í—Ä–µ–º—è –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º —Ä–µ–∂–∏–º–µ |
| `stime` | `/proc/<pid>/stat` (–ø–æ–ª–µ 15) | –í—Ä–µ–º—è –≤ —Ä–µ–∂–∏–º–µ —è–¥—Ä–∞ |
| `read_bytes` | `/proc/<pid>/io` | –ü—Ä–æ—á–∏—Ç–∞–Ω–æ –±–∞–π—Ç |
| `write_bytes` | `/proc/<pid>/io` | –ó–∞–ø–∏—Å–∞–Ω–æ –±–∞–π—Ç |

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –µ–¥–∏–Ω–∏—Ü –∏–∑–º–µ—Ä–µ–Ω–∏—è:**

```cpp
static std::string formatValue(const std::string& raw, const std::string& unit, const int hz) {
    if (unit == "raw") return raw;
    
    const double val = std::stod(raw);
    std::ostringstream oss;
    
    if (unit == "KiB")
        oss << std::fixed << std::setprecision(2) << val << " KiB";
    else if(unit == "MiB")
        // –ó–Ω–∞—á–µ–Ω–∏—è –∏–∑ /proc/status –£–ñ–ï –≤ KiB, –ø–æ—ç—Ç–æ–º—É –¥–µ–ª–∏–º —Ç–æ–ª—å–∫–æ –Ω–∞ 1024
        oss << std::fixed << std::setprecision(2) << val / 1024.0 << " MiB";
    else if (unit == "ticks")
        oss << val << " ticks (" << val / hz << " sec)";
    else
        oss << raw;
    
    return oss.str();
}
```

**–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ HZ:**

```cpp
const long hz = sysconf(_SC_CLK_TCK);  // –û–±—ã—á–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 100
```

---

## –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ —É—Ç–∏–ª–∏—Ç–∞–º–∏

### –¢–µ—Å—Ç–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å

**PID:** 18008  
**–ü—Ä–æ—Ü–µ—Å—Å:** Discord (–º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–µ GUI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)  
**–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã:** ~35 –º–∏–Ω—É—Ç CPU time  
**–ú–æ–º–µ–Ω—Ç —Å–Ω—è—Ç–∏—è –ø–æ–∫–∞–∑–∞–Ω–∏–π:** 00:36:23, 03.10.2025

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

```bash
# –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è —É—Ç–∏–ª–∏—Ç–∞
./pstat 18008

# –ü—Ä—è–º–æ–µ —á—Ç–µ–Ω–∏–µ /proc
cat /proc/18008/status | grep -E "ctxt_switches"
cat /proc/18008/io | grep -E "bytes"

# –°–∏—Å—Ç–µ–º–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã
top -p 18008 -b -n 1
ps -p 18008 -o pid,ppid,state,thcount,utime,stime,rss,comm
pidstat -p 18008
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

#### –í—ã–≤–æ–¥ pstat

```
PPid 17892
State S
Threads 44
VmRSS 461.97 MiB
RssAnon 296664.00 KiB
RssFile 173984.00 KiB
voluntary_ctxt_switches 54681
nonvoluntary_ctxt_switches 21379
utime 183543 ticks (1835.43 sec)
stime 27903 ticks (279.03 sec)
read_bytes 991232
write_bytes 32989184
```

#### –í—ã–≤–æ–¥ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç

**cat /proc/18008/status:**
```
voluntary_ctxt_switches:	54681
nonvoluntary_ctxt_switches:	21379
```

**cat /proc/18008/io:**
```
read_bytes: 991232
write_bytes: 32989184
cancelled_write_bytes: 0
```

**top:**
```
PID   USER   VIRT     RES    SHR  S  %CPU  %MEM    TIME+     COMMAND
18008 luni   1399.0g  473056 176392 S  70.0  2.9   35:14.57  Discord
```

**ps:**
```
PID    PPID  S  THCNT  UTIME  STIME    RSS    COMMAND
18008  17892 S  44     -      –æ–∫—Ç02    473056 Discord
```

**pidstat:**
```
UID    PID     %usr  %system  %guest  %wait  %CPU  CPU  Command
1000   18008   11.32 1.72     0.00    0.01   13.04 0    Discord
```

---

## –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –º–µ—Ç—Ä–∏–∫

| –ú–µ—Ç—Ä–∏–∫–∞ | pstat | cat /proc | top | ps | pidstat | –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|---------|-------|-----------|-----|----|---------|-----------:|-------------|
| **PPid** | 17892 | - | - | 17892 | - | ‚úì | –†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–≤–ø–∞–¥–∞–µ—Ç |
| **State** | S | - | S | S | - | ‚úì | Sleeping - –ø—Ä–æ—Ü–µ—Å—Å –æ–∂–∏–¥–∞–µ—Ç —Å–æ–±—ã—Ç–∏–π |
| **Threads** | 44 | - | - | 44 | - | ‚úì | –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ |
| **VmRSS** | 461.97 MiB | - | 473056 KiB | 473056 KiB | - | ‚úì | 473056 KiB √∑ 1024 = 461.97 MiB ‚úì |
| **RssAnon** | 296664.00 KiB | - | - | - | - | - | ~289.7 MiB, —Ç–æ–ª—å–∫–æ –≤ /proc/status |
| **RssFile** | 173984.00 KiB | - | - | - | - | - | ~169.9 MiB, —Ç–æ–ª—å–∫–æ –≤ /proc/status |
| **vol. ctx sw.** | 54681 | 54681 | - | - | - | ‚úì | –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å /proc |
| **nonvol. ctx sw.** | 21379 | 21379 | - | - | - | ‚úì | –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å /proc |
| **utime** | 1835.43 sec | - | - | - | - | ‚úì | ~30.6 –º–∏–Ω—É—Ç –≤ user mode |
| **stime** | 279.03 sec | - | - | - | - | ‚úì | ~4.65 –º–∏–Ω—É—Ç –≤ kernel mode |
| **CPU time total** | 2114.46 sec | - | 35:14.57 | - | - | ‚úì | 2114.46 sec = 35 –º–∏–Ω 14.46 —Å–µ–∫ ‚úì |
| **read_bytes** | 991232 | 991232 | - | - | - | ‚úì | ~968 KiB –ø—Ä–æ—á–∏—Ç–∞–Ω–æ |
| **write_bytes** | 32989184 | 32989184 | - | - | - | ‚úì | ~31.5 MiB –∑–∞–ø–∏—Å–∞–Ω–æ |
| **%CPU (–º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π)** | - | - | 70.0% | - | 13.04% | ‚ö†Ô∏è | –†–∞–∑–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è |

---

## –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π

### ‚úì –ü–æ–ª–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫

1. **VmRSS ‚Äî –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:** 461.97 MiB (pstat) = 473056 KiB (top/ps) = 461.97 MiB ‚úì
2. **Context switches ‚Äî –∏–¥–µ–Ω—Ç–∏—á–Ω—ã:** –ø—Ä—è–º–æ–µ —á—Ç–µ–Ω–∏–µ –∏–∑ `/proc`, –ø–æ–ª–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
3. **I/O bytes ‚Äî –∏–¥–µ–Ω—Ç–∏—á–Ω—ã:** –ø—Ä—è–º–æ–µ —á—Ç–µ–Ω–∏–µ –∏–∑ `/proc`
4. **CPU time ‚Äî —Å–æ–≤–ø–∞–¥–∞–µ—Ç:** 2114.46 —Å–µ–∫ (pstat) ‚âà 35:14.57 (top), —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ 0.11 —Å–µ–∫ (0.005%)

### ‚ö†Ô∏è –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–∞–∑–ª–∏—á–∏—è

**–ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π %CPU:**
- top: 70.0% (–ø–∏–∫–æ–≤–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –≤ –º–æ–º–µ–Ω—Ç –∑–∞–º–µ—Ä–∞)
- pidstat: 13.04% (—Å—Ä–µ–¥–Ω—è—è –∑–∞ –≤—Å—ë –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã)
- –û–±–∞ –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã, –∏–∑–º–µ—Ä—è—é—Ç —Ä–∞–∑–Ω–æ–µ

**ps –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç UTIME/STIME:**
- –î–ª—è –¥–æ–ª–≥–æ–∂–∏–≤—É—â–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞—Ç—É –∑–∞–ø—É—Å–∫–∞ –≤–º–µ—Å—Ç–æ –≤—Ä–µ–º–µ–Ω–∏

### üìä –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ó–Ω–∞—á–µ–Ω–∏–µ | % –æ—Ç RSS | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|----------|----------|----------|
| **RssAnon** | 289.7 MiB | 62.7% | Heap, stack (—Ä–µ–∞–ª—å–Ω–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ) |
| **RssFile** | 169.9 MiB | 36.8% | –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏, mmap (—Ä–∞–∑–¥–µ–ª—è–µ–º–∞—è –ø–∞–º—è—Ç—å) |
| **–ò—Ç–æ–≥–æ VmRSS** | 461.97 MiB | 100% | - |

---

## –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è

### 1. CPU Time –≤ —Å–µ–∫—É–Ω–¥–∞—Ö

**–§–æ—Ä–º—É–ª–∞:** `CPU_time_sec = (utime + stime) / HZ`

**–†–∞—Å—á—ë—Ç –¥–ª—è Discord:**
- HZ = 100 (–∏–∑ `sysconf(_SC_CLK_TCK)`)
- utime = 183543 ticks ‚Üí 1835.43 —Å–µ–∫
- stime = 27903 ticks ‚Üí 279.03 —Å–µ–∫
- **Total** = 2114.46 —Å–µ–∫ = 35 –º–∏–Ω 14.46 —Å–µ–∫

**–ü—Ä–æ–≤–µ—Ä–∫–∞:** top –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 35:14.57 ‚Üí —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ 0.11 —Å–µ–∫ ‚úì

### 2. RSS –≤ MiB

**–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞:** `RSS_MiB = VmRSS_KiB / 1024`

**–†–∞—Å—á—ë—Ç:**
- VmRSS = 473056 KiB (–∏–∑ `/proc/status`)
- RSS_MiB = 473056 √∑ 1024 = **461.97 MiB** ‚úì

### 3. I/O –≤ —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–º –≤–∏–¥–µ

- read_bytes = 991232 –±–∞–π—Ç = **968 KiB** = 0.95 MiB
- write_bytes = 32989184 –±–∞–π—Ç = **31.46 MiB**

**–°—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å –∑–∞ 35 –º–∏–Ω—É—Ç:**
- Read: ~0.46 KiB/—Å–µ–∫ (–æ—á–µ–Ω—å –Ω–∏–∑–∫–∞—è)
- Write: ~15.4 KiB/—Å–µ–∫ (–Ω–∏–∑–∫–∞—è)

### 4. Context Switches

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- voluntary: 54681 (–ø—Ä–æ—Ü–µ—Å—Å —Å–∞–º –æ—Ç–¥–∞–ª CPU)
- nonvoluntary: 21379 (–ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–±—Ä–∞–ª CPU)
- –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ: 2.56 (—Ö–æ—Ä–æ—à–æ ‚Äî –ø—Ä–æ—Ü–µ—Å—Å –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–µ–Ω)
- –ß–∞—Å—Ç–æ—Ç–∞: 36 –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–π/—Å–µ–∫ (–Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è GUI)

---

## –û—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –∏–∑ –∑–∞–¥–∞–Ω–∏—è

### 1. –ì–¥–µ –≤ `/proc/<pid>/stat` –∏ `/proc/<pid>/status` –æ—Ç—Ä–∞–∂–∞—é—Ç—Å—è –≤—Ä–µ–º—è –≤ —è–¥—Ä–µ/–≤ —é–∑–µ—Ä–µ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞?

**–û—Ç–≤–µ—Ç:**

–í `/proc/<pid>/stat`:
- **–ü–æ–ª–µ 3** ‚Äî state (R/S/D/Z/T)
- **–ü–æ–ª–µ 14** ‚Äî utime (user mode time –≤ —Ç–∞–∫—Ç–∞—Ö)
- **–ü–æ–ª–µ 15** ‚Äî stime (kernel mode time –≤ —Ç–∞–∫—Ç–∞—Ö)

–í `/proc/<pid>/status`:
- –°—Ç—Ä–æ–∫–∞ `State:` ‚Äî —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º –≤–∏–¥–µ

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è: `fields[13]` –¥–ª—è utime, `fields[14]` –¥–ª—è stime (–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è —Å 0).

---

### 2. –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å RSS –∏ —á–µ–º –æ—Ç–ª–∏—á–∞—é—Ç—Å—è RssAnon –∏ RssFile? –ü–æ—á–µ–º—É –æ–Ω–∏ –≤–∞–∂–Ω—ã?

**–û—Ç–≤–µ—Ç:**

**VmRSS** ‚Äî –∏–∑ `/proc/<pid>/status`, —Å—Ç—Ä–æ–∫–∞ `VmRSS:` (–∑–Ω–∞—á–µ–Ω–∏–µ –≤ KiB).

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- **RssAnon** ‚Äî –∞–Ω–æ–Ω–∏–º–Ω–∞—è –ø–∞–º—è—Ç—å (heap, stack, anonymous mmap). –†–µ–∞–ª—å–Ω–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º.
- **RssFile** ‚Äî —Ñ–∞–π–ª–æ–≤–∞—è –ø–∞–º—è—Ç—å (–±–∏–±–ª–∏–æ—Ç–µ–∫–∏, mmap —Ñ–∞–π–ª–æ–≤). –†–∞–∑–¥–µ–ª—è–µ—Ç—Å—è –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏.

**–í–∞–∂–Ω–æ—Å—Ç—å:**
- RssAnon –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "–Ω–∞—Å—Ç–æ—è—â–µ–µ" –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ (–ø—Ä–∏ —É—Ç–µ—á–∫–∞—Ö —Ä–∞—Å—Ç—ë—Ç –∏–º–µ–Ω–Ω–æ –æ–Ω)
- RssFile —Ä–∞–∑–¥–µ–ª—è–µ—Ç—Å—è
- –î–ª—è Discord: RssAnon = 289.7 MiB (—Ä–µ–∞–ª—å–Ω–æ "–≤–ª–∞–¥–µ–µ—Ç"), RssFile = 169.9 MiB (—Ä–∞–∑–¥–µ–ª—è–µ—Ç)

---

### 3. –ö–∞–∫ –æ—Ü–µ–Ω–∏—Ç—å IO-–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ `/proc/<pid>/io` –∏ —á–µ–º –æ–Ω–∞ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç ¬´–æ–∂–∏–¥–∞–Ω–∏—è IO¬ª –≤ `top/pidstat`?

**–û—Ç–≤–µ—Ç:**

**`/proc/<pid>/io`:**
- `read_bytes/write_bytes` ‚Äî **—Å–∫–æ–ª—å–∫–æ** –±–∞–π—Ç –ø—Ä–æ—á–∏—Ç–∞–Ω–æ/–∑–∞–ø–∏—Å–∞–Ω–æ (–∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ)
- –î–ª—è —Ä–∞—Å—á—ë—Ç–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏: —Å–Ω—è—Ç—å –ø–æ–∫–∞–∑–∞–Ω–∏—è –¥–≤–∞–∂–¥—ã, –≤—ã—á–∏—Å–ª–∏—Ç—å –¥–µ–ª—å—Ç—É

**`%iowait` (top):**
- **–ö–∞–∫ –¥–æ–ª–≥–æ** CPU –ø—Ä–æ—Å—Ç–∞–∏–≤–∞–ª –≤ –æ–∂–∏–¥–∞–Ω–∏–∏ IO (% –≤—Ä–µ–º–µ–Ω–∏, —Å–∏—Å—Ç–µ–º–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞)

**`%wait` (pidstat):**
- **–ö–∞–∫ –¥–æ–ª–≥–æ** –ø—Ä–æ—Ü–µ—Å—Å –±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –Ω–∞ IO (% –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞)

**–†–∞–∑–ª–∏—á–∏–µ:** `/proc/io` ‚Äî –æ–±—ä—ë–º (–±–∞–π—Ç—ã), `top/pidstat` ‚Äî –≤—Ä–µ–º—è (–ø—Ä–æ—Ü–µ–Ω—Ç—ã).

**–î–ª—è Discord:** write_bytes = 31.46 MiB (–æ–±—ä—ë–º), %wait = 0.01% (–ø–æ—á—Ç–∏ –Ω–µ –∂–¥—ë—Ç) ‚Üí IO –Ω–µ bottleneck.

---

### 4. –ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –¥–µ–ª–∏—Ç–µ–ª—å HZ –∏ –∫–∞–∫ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å CPU time sec?

**–û—Ç–≤–µ—Ç:**

**HZ** ‚Äî —á–∞—Å—Ç–æ—Ç–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —Ç–∞–π–º–µ—Ä–∞ (—Ç–∞–∫—Ç–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É), –æ–±—ã—á–Ω–æ 100.

**–ü–æ–ª—É—á–µ–Ω–∏–µ:** `long hz = sysconf(_SC_CLK_TCK);`

**–§–æ—Ä–º—É–ª–∞:** `CPU_time_sec = (utime + stime) / HZ`

**–ü—Ä–∏–º–µ—Ä –¥–ª—è Discord:**
- utime = 183543 ticks, stime = 27903 ticks, HZ = 100
- Total = (183543 + 27903) / 100 = **2114.46 —Å–µ–∫**

**–í–∞–∂–Ω–æ—Å—Ç—å:** –ë–µ–∑ `sysconf` –ø—Ä–∏–¥—ë—Ç—Å—è —Ö–∞—Ä–¥–∫–æ–¥–∏—Ç—å HZ, —á—Ç–æ —Å–ª–æ–º–∞–µ—Ç—Å—è –Ω–∞ —Å–∏—Å—Ç–µ–º–∞—Ö —Å HZ ‚â† 100 (250, 1000).

---

### 5. –ü–æ—á–µ–º—É –≤–æ–∑–º–æ–∂–Ω—ã —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É `/proc` –∏ –≤—ã–≤–æ–¥–æ–º `ps/top`? –ö–æ–≥–¥–∞ —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ?

**–û—Ç–≤–µ—Ç:**

**–ü—Ä–∏—á–∏–Ω—ã:**
1. –ü—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –º–µ–∂–¥—É —á—Ç–µ–Ω–∏—è–º–∏ (–¥–ª—è Discord: +0.11 —Å–µ–∫ –∑–∞ ~1 –º—Å)
2. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —É—Ç–∏–ª–∏—Ç–∞—Ö (top –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Ä–∞–∑ –≤ 3 —Å–µ–∫)
3. –†–∞–∑–Ω—ã–µ –º–µ—Ç–æ–¥—ã —Ä–∞—Å—á—ë—Ç–∞ (%CPU: –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π vs —Å—Ä–µ–¥–Ω–∏–π)
4. –ù–µ–∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å —á—Ç–µ–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ `/proc`

**–ù–µ –∫—Ä–∏—Ç–∏—á–Ω–æ:**
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–æ–ª–≥–æ–∂–∏–≤—É—â–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (–ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å 0.005%)
- –û–±—â–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (—Ç–æ—á–Ω–æ—Å—Ç—å ¬±1 MiB –¥–æ–ø—É—Å—Ç–∏–º–∞)

**–ö—Ä–∏—Ç–∏—á–Ω–æ:**
- –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–Ω—É–∂–Ω–∞ –º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å)
- –î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—Ä–∞—Ç–∫–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤—Å–ø–ª–µ—Å–∫–æ–≤ (–º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å)
- –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–º–µ—Ä—ã –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

**–î–ª—è Discord:** –†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ 0.11 —Å–µ–∫ –∏–∑ 2114 —Å–µ–∫ (0.005%) ‚Äî –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.

---

### 6. (–î–ª—è E*) –ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `strace -c` –∏ –∫–∞–∫ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å `perf stat`?

**–û—Ç–≤–µ—Ç:**

**`strace -c`:**
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, –≤—Ä–µ–º—è, –æ—à–∏–±–∫–∏
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω—ã: IO-bound (–º–Ω–æ–≥–æ read/write), CPU-bound (–º–∞–ª–æ syscalls), –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω—ã–π (–º–Ω–æ–≥–æ futex)

**`perf stat`:**
- –ê–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ —Å—á—ë—Ç—á–∏–∫–∏: cycles, instructions, branches, cache misses
- **IPC** (insn per cycle): > 2.0 –æ—Ç–ª–∏—á–Ω–æ, < 0.5 –ø–ª–æ—Ö–æ (–º–Ω–æ–≥–æ stalls)
- **branch-misses**: < 2% –æ—Ç–ª–∏—á–Ω–æ, > 15% –ø–ª–æ—Ö–æ (–Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–π –∫–æ–¥)

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ bottleneck (CPU, IO, –ø–∞–º—è—Ç—å, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è).

---

## –í—ã–≤–æ–¥—ã

**–£—Å–ø–µ—à–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
1. ‚úÖ –£—Ç–∏–ª–∏—Ç–∞ `pstat` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —á–∏—Ç–∞–µ—Ç `/proc/<pid>/*` –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –º–µ—Ç—Ä–∏–∫–∏
2. ‚úÖ –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å `ps/top/pidstat` –ø–æ–∫–∞–∑–∞–ª–æ –ø–æ–ª–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫ (PPid, State, Threads, VmRSS, CPU time, context switches, I/O bytes)
3. ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ HZ —á–µ—Ä–µ–∑ `sysconf(_SC_CLK_TCK)` –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ—Ä—Ç–∞—Ç–∏–≤–Ω–æ—Å—Ç—å
4. ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: VmRSS (KiB‚ÜíMiB), CPU time (ticks‚Üísec)

**–ö–ª—é—á–µ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è Discord (PID 18008):**
- –ü–∞–º—è—Ç—å: 461.97 MiB (289.7 MiB —Ä–µ–∞–ª—å–Ω–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ, 169.9 MiB –±–∏–±–ª–∏–æ—Ç–µ–∫–∏)
- CPU: 35 –º–∏–Ω—É—Ç 14 —Å–µ–∫ (30.6 –º–∏–Ω user mode, 4.65 –º–∏–Ω kernel mode)
- I/O: –ù–∏–∑–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (~15 KiB/—Å–µ–∫ –∑–∞–ø–∏—Å–∏, 0.5 KiB/—Å–µ–∫ —á—Ç–µ–Ω–∏—è)
- Context switches: 36/—Å–µ–∫ (–∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ)

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å:**
- –ü—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –¥–µ—Ç–∞–ª—å–Ω—ã–º –º–µ—Ç—Ä–∏–∫–∞–º (RssAnon/RssFile –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –≤ ps/top)
- –ö–∞—Å—Ç–æ–º–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏—è
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ: –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏, –∞–Ω–∞–ª–∏–∑ IO-–ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤

---

## –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –û–∫—Ä—É–∂–µ–Ω–∏–µ
- **–û–°:** Linux 6.14.0-32-generic (Ubuntu), x86_64
- **HZ:** 100 (—á–µ—Ä–µ–∑ `sysconf(_SC_CLK_TCK)`)

### –°–±–æ—Ä–∫–∞
```bash
cd src/
g++ -std=c++11 pstat.cpp -o pstat
```

### –ó–∞–ø—É—Å–∫
```bash
PID=18008  # –∏–ª–∏ –ª—é–±–æ–π –¥—Ä—É–≥–æ–π –ø—Ä–æ—Ü–µ—Å—Å

./pstat $PID
ps -p $PID -o pid,ppid,state,thcount,rss,comm
top -p $PID -b -n 1
pidstat -p $PID
cat /proc/$PID/status | grep -E "ctxt"
cat /proc/$PID/io | grep -E "bytes"
```

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- –¢—Ä–µ–±—É—é—Ç—Å—è –ø—Ä–∞–≤–∞ –Ω–∞ —á—Ç–µ–Ω–∏–µ `/proc/<pid>/io` (–ø—Ä–æ—Ü–µ—Å—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ root)
- `/proc/<pid>/smaps_rollup` –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –ù–∞ WSL2/macOS –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å `/proc` –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞

---
