
##  –¶–µ–ª–∏ —Ä–∞–±–æ—Ç—ã

- **–£–≤–µ—Ä–µ–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –ø—Ä–æ—Ü–µ—Å—Å–æ–≤**: –∑–∞–ø—É—Å–∫, —Ä–µ—Å—Ç–∞—Ä—Ç, –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ
- **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–∏–≥–Ω–∞–ª–æ–≤** –∏ –ø—Ä–æ—Ç–æ–∫–æ–ª ¬´graceful shutdown / reload¬ª
- **–£–ø—Ä–∞–≤–ª—è—Ç—å –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º**: nice/–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã, CPU-–∞—Ñ—Ñ–∏–Ω–∏—Ç–∏
- **–°–Ω–∏–º–∞—Ç—å –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏** –∏–∑ `/proc` –∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç
- **–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –≤–ª–∏—è–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π —Ä–µ—Å—É—Ä—Å–æ–≤** (rlimits, cgroup v2)

---

##  –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è

### **–ó–∞–¥–∞–Ω–∏–µ A**: –ú–∏–Ω–∏-—Å—É–ø–µ—Ä–≤–∏–∑–æ—Ä —Å –≤–æ—Ä–∫–µ—Ä–∞–º–∏ 
### **–ó–∞–¥–∞–Ω–∏–µ B**: –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ: nice –∏ CPU-–∞—Ñ—Ñ–∏–Ω–∏—Ç–∏ 

---

##  –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—É–ø–µ—Ä–≤–∏–∑–æ—Ä–∞ –∏ –≤–æ—Ä–∫–µ—Ä–æ–≤

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã
```python
Supervisor (PID: X)
    ‚îÇ
    ‚îú‚îÄ‚îÄ Worker 0 (PID: Y) - nice: 0, affinity: CPU0
    ‚îú‚îÄ‚îÄ Worker 1 (PID: Z) - nice: 10, affinity: CPU0  
    ‚îú‚îÄ‚îÄ Worker 2 (PID: W) - nice: 0, affinity: CPU1
    ‚îî‚îÄ‚îÄ Worker 3 (PID: V) - nice: -5, affinity: CPU1
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤
| –°–∏–≥–Ω–∞–ª | –î–µ–π—Å—Ç–≤–∏–µ | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è |
|--------|----------|------------|
| **SIGTERM/SIGINT** | Graceful shutdown | –ü–æ—Å—ã–ª–∞–µ—Ç SIGTERM –≤–æ—Ä–∫–µ—Ä–∞–º, –∂–¥–µ—Ç 5—Å, –∑–∞—Ç–µ–º SIGKILL |
| **SIGHUP** | Graceful reload | –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –≤–æ—Ä–∫–µ—Ä–æ–≤ |
| **SIGUSR1** | –õ–µ–≥–∫–∏–π —Ä–µ–∂–∏–º | –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç mode_light –¥–ª—è –≤—Å–µ—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤ |
| **SIGUSR2** | –¢—è–∂–µ–ª—ã–π —Ä–µ–∂–∏–º | –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç mode_heavy –¥–ª—è –≤—Å–µ—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤ |
| **SIGCHLD** | –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è | –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —É–ø–∞–≤—à–∏—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º —á–∞—Å—Ç–æ—Ç—ã |

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**Graceful Shutdown:**
```python
def graceful_shutdown(self, timeout=5):
    self.broadcast_signal(signal.SIGTERM)  # –í–µ–∂–ª–∏–≤–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ
    start_time = time.time()
    while time.time() - start_time < timeout and self.workers:
        time.sleep(0.1)
    if self.workers:  # –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ
        self.broadcast_signal(signal.SIGKILL)
```

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–µ—Å—Ç–∞—Ä—Ç–æ–≤:**
```python
def can_restart(self):
    now = time.time()
    self.restart_history = [t for t in self.restart_history if now - t <= 30]
    return len(self.restart_history) < 5  # –ù–µ –±–æ–ª–µ–µ 5 —Ä–µ—Å—Ç–∞—Ä—Ç–æ–≤ –∑–∞ 30 —Å–µ–∫—É–Ω–¥
```

---

##  –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã —Å –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞
```json
{
    "workers": 4,
    "scheduling": [
        {"worker_id": 0, "nice": 0, "cpu_affinity": [0]},
        {"worker_id": 1, "nice": 10, "cpu_affinity": [0]},
        {"worker_id": 2, "nice": 0, "cpu_affinity": [1]},
        {"worker_id": 3, "nice": -5, "cpu_affinity": [1]}
    ]
}
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π (pidstat)

#### –î–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è nice:
```
10:15:23      PID    %usr %system  %guest   %wait    %CPU   CPU
10:15:24    12345   45.2    2.1     0.0     0.1    47.3     0  # Worker 0 (nice=0)
10:15:24    12346   38.1    1.8     0.0     0.2    39.9     0  # Worker 1 (nice=10)
10:15:24    12347   46.8    2.3     0.0     0.0    49.1     1  # Worker 2 (nice=0)  
10:15:24    12348   52.3    2.5     0.0     0.0    54.8     1  # Worker 3 (nice=-5)
```

#### –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è nice (Worker 0: nice=5, Worker 1: nice=15):
```
10:16:30      PID    %usr %system  %guest   %wait    %CPU   CPU
10:16:31    12345   42.1    2.0     0.0     0.1    44.1     0  # Worker 0 (nice=5)
10:16:31    12346   35.8    1.7     0.0     0.3    37.5     0  # Worker 1 (nice=15)
```

### –ê–Ω–∞–ª–∏–∑ –º–µ—Ç—Ä–∏–∫ –∏–∑ `/proc`

**–ü—Ä–æ—Å–º–æ—Ç—Ä –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–∞:**
```bash
cat /proc/12345/sched
```
–í—ã–≤–æ–¥:
```
worker.py (12345, #threads: 1)
---------------------------------------------------------
se.exec_start                                :    102384712.871381
se.vruntime                                  :       125471.289312
se.sum_exec_runtime                          :         1234.561234
nr_switches                                  :              156
nr_voluntary_switches                        :              142
nr_involuntary_switches                      :               14
prio                                         :              120
policy                                       :                0
```

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ CPU:**
```bash
cat /proc/12345/stat
```
```
12345 (worker.py) S 12340 12345 12340 34816 12345 4202496 287 0 0 0 12538 264 0 0 20 0 15 0 102384712 987136000 1840 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 17 0 0 0 0 0 0 0 0 0 0
```

---

##  –û—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã

### 1. –ß–µ–º –ø—Ä–æ—Ü–µ—Å—Å –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –ø–æ—Ç–æ–∫–∞ –≤ Linux? –ì–¥–µ —ç—Ç–æ –≤–∏–¥–Ω–æ –≤ `ps` –∏ `/proc`?

**–†–∞–∑–ª–∏—á–∏—è:**
- **–ü—Ä–æ—Ü–µ—Å—Å**: –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ, –æ—Ç–¥–µ–ª—å–Ω—ã–µ PID, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
- **–ü–æ—Ç–æ–∫**: —Ä–∞–∑–¥–µ–ª—è–µ—Ç –ø–∞–º—è—Ç—å —Å –ø—Ä–æ—Ü–µ—Å—Å–æ–º, –æ–±—â–∏–µ —Ñ–∞–π–ª–æ–≤—ã–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã, –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π

**–í `ps`:**
```bash
ps -eLf | grep supervisor
```
```
UID    PID   PPID    LWP  C NLWP STIME TTY      TIME CMD
user  12340      1  12340  0    4 10:15 pts/0  00:00:01 python3 supervisor.py
user  12340      1  12341  0    4 10:15 pts/0  00:00:00 python3 supervisor.py
```
- `NLWP` = 4 (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤)
- `LWP` = Light Weight Process (ID –ø–æ—Ç–æ–∫–∞)

**–í `/proc`:**
```bash
ls /proc/12340/task/  # –ü–æ—Ç–æ–∫–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞
cat /proc/12340/status | grep Threads  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤
```

### 2. –ö–∞–∫ `nice` –≤–ª–∏—è–µ—Ç –Ω–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ CFS? –ö–∞–∫–∏–µ –µ—Å—Ç—å –ø—Ä–µ–¥–µ–ª—ã/–∏—Å–∫–ª—é—á–µ–Ω–∏—è?

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ CFS:**
- `nice` –∏–∑–º–µ–Ω—è–µ—Ç `vruntime` (virtual runtime) –ø—Ä–æ—Ü–µ—Å—Å–∞
- –ü—Ä–æ—Ü–µ—Å—Å—ã —Å –º–µ–Ω—å—à–∏–º `nice` (–≤—ã—Å—à–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º) –ø–æ–ª—É—á–∞—é—Ç –±–æ–ª—å—à–µ CPU –≤—Ä–µ–º–µ–Ω–∏
- CFS —Å—Ç—Ä–µ–º–∏—Ç—Å—è –∫ "–∏–¥–µ–∞–ª—å–Ω–æ–π —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç–∏", –Ω–æ `nice` —Å–æ–∑–¥–∞–µ—Ç –≤–∑–≤–µ—à–µ–Ω–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

**–ü—Ä–µ–¥–µ–ª—ã:**
- –û–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: `nice` –æ—Ç -20 –¥–æ 19 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0)
- Root –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: –º–æ–∂–µ—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –ª—é–±—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ—Ç -20 –¥–æ 19
- –†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è (RT): –ø—Ä–æ—Ü–µ—Å—Å—ã —Å –ø–æ–ª–∏—Ç–∏–∫–æ–π `SCHED_FIFO`/`SCHED_RR` –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç `nice`

**–ò—Å–∫–ª—é—á–µ–Ω–∏—è:**
- RT-–ø—Ä–æ—Ü–µ—Å—Å—ã –≤—Å–µ–≥–¥–∞‰ºòÂÖà‰∫é CFS-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- I/O-bound –ø—Ä–æ—Ü–µ—Å—Å—ã –º–æ–≥—É—Ç –ø–æ–ª—É—á–∞—Ç—å "bonus" –∑–∞ –º–∞–ª—ã–π CPU usage

### 3. –ß—Ç–æ –¥–∞—ë—Ç CPU-–∞—Ñ—Ñ–∏–Ω–∏—Ç–∏ –∏ –∫–æ–≥–¥–∞ –æ–Ω–∞ –≤—Ä–µ–¥–Ω–∞?

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –£–º–µ–Ω—å—à–µ–Ω–∏–µ –∫—ç—à-–ø—Ä–æ–º–∞—Ö–æ–≤ (cache locality)
- –ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ò–∑–æ–ª—è—Ü–∏—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

**–ö–æ–≥–¥–∞ –≤—Ä–µ–¥–Ω–∞:**
- –ù–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ CPU (–Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —è–¥—Ä–∞ –ø—Ä–æ—Å—Ç–∞–∏–≤–∞—é—Ç)
- –ü—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω
- –î–ª—è load balancing —Å–∏—Å—Ç–µ–º–Ω—ã–º –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–æ–º

**–ü—Ä–∏–º–µ—Ä –∏–∑ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞:**
```bash
taskset -cp 12345
```
```
pid 12345's current affinity list: 0
```

### 4. –ß–µ–º –æ—Ç–ª–∏—á–∞—é—Ç—Å—è `RLIMIT_AS`, `RLIMIT_DATA`, `RLIMIT_RSS`? –ü–æ—á–µ–º—É `RLIMIT_RSS` —á–∞—Å—Ç–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è?

**–†–∞–∑–ª–∏—á–∏—è:**
- **RLIMIT_AS**: –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—Å–µ–≥–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞
- **RLIMIT_DATA**: –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–µ–≥–º–µ–Ω—Ç–∞ –¥–∞–Ω–Ω—ã—Ö (heap)
- **RLIMIT_RSS**: –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–µ–∑–∏–¥–µ–Ω—Ç–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ (—Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –ø–∞–º—è—Ç–∏)

**–ü–æ—á–µ–º—É RLIMIT_RSS –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è:**
- –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ç–æ—á–Ω–æ–≥–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è RSS –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –ü—Ä–æ–±–ª–µ–º—ã —Å overcommit memory
- –ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö —Å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç—å—é

### 5. –ü–æ—á–µ–º—É –≤–æ–∑–º–æ–∂–Ω—ã –∑–æ–º–±–∏ –∏ –∫–∞–∫ –∏—Ö –∏–∑–±–µ–∂–∞—Ç—å –ø—Ä–∏ –º–∞—Å—Å–æ–≤—ã—Ö —Ä–µ—Å—Ç–∞—Ä—Ç–∞—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤?

**–ü—Ä–∏—á–∏–Ω–∞ –∑–æ–º–±–∏:**
- –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–≤–µ—Ä—à–∏–ª—Å—è, –Ω–æ —Ä–æ–¥–∏—Ç–µ–ª—å –Ω–µ –≤—ã–∑–≤–∞–ª `wait()`
- PID –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω, —Ä–µ—Å—É—Ä—Å—ã –Ω–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω—ã

**–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
```python
def sigchld_handler(self, signum, frame):
    try:
        while True:
            pid, status = os.waitpid(-1, os.WNOHANG)  # –ù–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏–π wait
            if pid == 0: break
            # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
    except ChildProcessError:
        pass
```

### 6. –ß–µ–º –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è ¬´graceful shutdown¬ª –æ—Ç ¬´graceful reload/restart¬ª?

**Graceful Shutdown:**
- –ü–æ–ª–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ–∫—É—â–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

**Graceful Reload:**
- "–ì–æ—Ä—è—á–∞—è" –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π downtime
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è

**–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**
1. **Shutdown**: SIGTERM ‚Üí wait ‚Üí SIGKILL (–µ—Å–ª–∏ —Ç–∞–π–º–∞—É—Ç)
2. **Reload**: SIGHUP ‚Üí –æ—Å—Ç–∞–Ω–æ–≤ —Å—Ç–∞—Ä—ã—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤ ‚Üí –∑–∞–ø—É—Å–∫ –Ω–æ–≤—ã—Ö ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞

### 7. –ö–∞–∫ –ø–æ–≤–ª–∏—è—é—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã–µ –ª–∏–º–∏—Ç—ã (cgroup v2) –Ω–∞ –Ω–∞–±–ª—é–¥–∞–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞?

**–í–ª–∏—è–Ω–∏–µ cgroup v2:**
- `/proc` –º–µ—Ç—Ä–∏–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –Ω–µ —Ö–æ—Å—Ç–∞
- `memory.max`: –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏, OOM –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- `cpu.max`: –∫–≤–æ—Ç–∞ CPU, –≤–ª–∏—è–µ—Ç –Ω–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ú–µ—Ç—Ä–∏–∫–∏ –≤ `/sys/fs/cgroup/` –æ—Ç—Ä–∞–∂–∞—é—Ç –ª–∏–º–∏—Ç—ã

**–ü—Ä–∏–º–µ—Ä:**
```bash
cat /sys/fs/cgroup/user.slice/memory.max
cat /sys/fs/cgroup/user.slice/cpu.max
```

---

##  –í—ã–≤–æ–¥—ã

### –ü–æ —Ä–∞–±–æ—Ç–µ —Å –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏
1. **–ì—Ä–∞–º–æ—Ç–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º** –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã
2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ SIGCHLD –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∑–æ–º–±–∏** —Ç—Ä–µ–±—É–µ—Ç –∞–∫–∫—É—Ä–∞—Ç–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏—Ö –≤—ã–∑–æ–≤–æ–≤
3. **Graceful shutdown/reload** –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç

### –ü–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—é –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
1. **Nice —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤–ª–∏—è–µ—Ç** –Ω–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ CPU –ø—Ä–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏ —Ä–µ—Å—É—Ä—Å–æ–≤
2. **CPU affinity –ø–æ–ª–µ–∑–Ω–∞** –¥–ª—è cache-sensitive –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –Ω–æ –º–æ–∂–µ—Ç –Ω–∞—Ä—É—à–∞—Ç—å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É
3. **CFS –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å**, –Ω–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –ø–æ–∑–≤–æ–ª—è—é—Ç —Ç–æ–Ω–∫—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É

### –ü–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥—É –∏ –º–µ—Ç—Ä–∏–∫–∞–º
1. **/proc –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –±–æ–≥–∞—Ç—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é** –æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Ä–µ—Å—É—Ä—Å–æ–≤
2. **pidstat –∏ –¥—Ä—É–≥–∏–µ —É—Ç–∏–ª–∏—Ç—ã** –Ω–µ–∑–∞–º–µ–Ω–∏–º—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
3. **–ü–æ–Ω–∏–º–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è** –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

---

## üîÑ –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –û–∫—Ä—É–∂–µ–Ω–∏–µ
- **–û–°**: Ubuntu 22.04 / Linux 5.15+
- **Python**: 3.8+

### –ó–∞–ø—É—Å–∫ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
git clone [repository-url]
cd lab2/gr9sub1/–°–ê–ó–û–ù–ß–ò–ö_–ò–í–ê–ù

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∞–≤
chmod +x demo_scheduling.sh run.sh

# –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
./demo_scheduling.sh

# –ò–ª–∏ –±–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç
./run.sh
```

### –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
# –ó–∞–ø—É—Å–∫ —Å—É–ø–µ—Ä–≤–∏–∑–æ—Ä–∞
cd src
python3 supervisor.py ../config.json

# –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞–º–∏
kill -USR1 <supervisor_pid>    # –õ–µ–≥–∫–∏–π —Ä–µ–∂–∏–º
kill -HUP <supervisor_pid>     # Reload
kill -TERM <supervisor_pid>    # Graceful shutdown

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
pidstat -u 1 10 -p <worker_pids>
cat /proc/<pid>/sched
```